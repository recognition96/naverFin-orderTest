<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <title>item List</title>
    <script src="https://code.jquery.com/jquery-latest.min.js"></script>
    <script>
        var searchItem = function(){
            console.log("get item list");
            var selectedOption = $("#searchType option:selected").val();
            var searchKeyword = $("#keywordInput").val();
            console.log(selectedOption);
            console.log(searchKeyword);
            if(selectedOption === "base" && searchKeyword === "") {
                console.log("else");
                $.ajax({
                    method: 'GET',
                    url: '/api/items',
                    success : function(data) {
                        console.log(data);
                        for(var item in data) {
                            $("#output").append(JSON.stringify(data[item]) + "<br>");
                        }
                    },
                    error : function(e) {
                        console.log(e.responseText);
                    }
                });
            }
            else if(selectedOption !== "base" && searchKeyword !== "") {
                $("#output").html("");
                $.ajax({
                    method: 'GET',
                    url: `/api/items?option=${selectedOption}&keyword=${searchKeyword}`,
                    success : function(data) {
                        console.log(data);
                        if(data) {
                            for (var item in data) {
                                $("#output").append(JSON.stringify(data[item]) + "<br>");
                            }
                        }
                    },
                    error : function(e) {
                        console.log(e.responseText);
                    }
                });
            }
        };
        $(function() {
            searchItem();
            $("#searchBtn").on("click", searchItem);
        });


    </script>
</head>
<body>
    <div class="outer">
        <div class="inner">
            <h1>items list</h1>
            <div id="output">

            </div>

            <div class="card-footer">
                <div class="row">
                    <div class="form-group col-sm-2">
                        <select class="form-control" name="searchType" id="searchType">
                            <option value="base">:::::: 선택 ::::::</option>
                            <option value="n">이름</option>
                            <option value="c">카테고리</option>
                            <option value="p">가격</option>
                        </select> </div> <div class="form-group col-sm-10">
                    <div class="input-group">
                        <input type="text" class="form-control" name="keyword" id="keywordInput" placeholder="검색어">
                        <span class="input-group-btn">
                            <button type="button" class="btn btn-primary btn-flat" id="searchBtn">
                                <i class="fa fa-search"></i> 검색
                            </button>
                        </span>
                    </div>
                </div>
                </div>
                <div class="float-right">
                    <button type="button" class="btn btn-success btn-flat" id="writeBtn">
                        <i class="fa fa-pencil"></i> 새 상품 등록
                    </button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>